<% set_meta_tags(
  title: "События",
  description: "Все события Вышки для студентов и работников университета",
  keywords: "События, Мероприятия, Ивенты, Тусовки, Вышка, НИУ ВШЭ, ВШЭ" )%>

<% content_for :title, "События" %>

<div class="C_Filters">
  <div>
    <label for="category_select">Тип события:</label>
    <select id="category_select" onchange="if(this.value) window.location.href=this.value;">
      <option value="<%= events_path %>" <%= params[:tag] ? '' : 'selected' %>>Все</option>
      <% Tag.categories_list.each do |tag| %>
        <option value="<%= tagged_events_path(tag.name) %>" <%= params[:tag] == tag.name ? 'selected' : '' %>>
          <%= tag.name %>
        </option>
      <% end %>
    </select>
  </div>

  <div>
    <label for="tag_select">Теги:</label>
    <select id="tag_select" onchange="if(this.value) window.location.href=this.value;">
      <option value="<%= events_path %>" <%= params[:tag] ? '' : 'selected' %>>Все</option>
      <% Tag.tags_list.each do |tag| %>
        <option value="<%= tagged_events_path(tag.name) %>" <%= params[:tag] == tag.name ? 'selected' : '' %>>
          <%= tag.name %>
        </option>
      <% end %>
    </select>
  </div>
</div>

<h1>События (<%= @events.count %>)</h1>
<div class="C_EventsAndMeets">
  <% @events.each do |event| %>
    <div class="M_EventCard">
      <%= link_to event_path(event) do %>
        <%= event.hosted_at.strftime("%d/%m/%Y %H:%M") %>
        <%= render event %>
      <% end %>
      <div class="C_Tags">
        <% event.tags.each do |tag| %>
          <%= link_to tag.name, tagged_events_path(tag.name), class: 'A_Tag' %>
        <% end %>
      </div>
      <div class="C_Tags">
        <% event.categories.each do |tag| %>
          <%= link_to tag.name, tagged_events_path(tag.name), class: 'A_Tag' %>
        <% end %>
      </div>
    </div>
  <% end %>
</div>

<%= link_to "New event", new_event_path %>